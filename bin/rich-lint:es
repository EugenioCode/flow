#!/usr/bin/env node

const { program } = require('commander');
const { oraPromise, command } = require('../lib/utils.js')
const chalk = require('chalk')

program
  .name('rich')
  .usage('lint:es [file] [dir]')
  .on('--help', () => {
    console.log('  Examples:')
    console.log()
    console.log(chalk.gray('    # format javascript code'))
    console.log('    $ rich lint:es')
    console.log()
  })
  .option('--fix', 'format code')
  .on('exit',console.log)
  .parse(process.argv)

const options = program.opts();

let pathes = process.argv.slice(2).filter(t=> !/^-+./.test(t))
pathes = pathes.length ? pathes : ['.']

function main () {
  let baseShell = `npx eslint --ext .js,.vue,.ts`
  if (options.fix) baseShell += ' --fix';
  
  baseShell += pathes.reduce((s, p) => s += ` ${p}`, '')

  oraPromise(command.bind(null, baseShell), {text: 'lint code'})
    .catch(console.log)
}

main()

