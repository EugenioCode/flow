#!/usr/bin/env node

const { program } = require('commander');
const { oraPromise, command } = require('../lib/utils.js')
const chalk = require('chalk')

program
  .name('rich')
  .usage('lint:style [path...]')
  .on('--help', () => {
    console.log('  例如:')
    console.log()
    console.log(chalk.gray('    # 格式化代码'))
    console.log('    $ rich lint:style')
    console.log()
  })
  .option('--fix', '自动修复')
  .on('exit',console.log)
  .parse(process.argv)

const options = program.opts();

const pathes = process.argv.slice(2).filter(t=> !/^-+./.test(t)) || []
const suffix= ' *.{css,scss,sass,less,vue}'

function main () {
  let baseShell = `npx stylelint`

  baseShell += pathes.length 
    ? pathes.reduce((s, p) => s += ` ${p}`, '')
    : suffix

  if (options.fix) baseShell += ' --fix';
  
  oraPromise(command.bind(null, baseShell), {text: '格式化'})
}

main()

